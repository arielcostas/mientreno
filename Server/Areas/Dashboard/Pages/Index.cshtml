@page
@using Microsoft.AspNetCore.Mvc.TagHelpers
@using System.Globalization
@using Humanizer
@model DashboardModel
@{
	ViewData["Title"] = "Dashboard";
}

<main id="main-invisible">
	<h1>@AppStrings.dashboard</h1>
	<div class="grid grid-3">
		<div class="card" id="card-alumnos">
			<h2>🎽 @AppStrings.Text_Dashboard_MyAlumnos_Title</h2>
			<div class="card-content">
				<p>@AppStrings.dashboard_AlumnosOutOf.FormatWith(Model.Alumnos, Model.MaxAlumnos)</p>
				<a asp-page="/Alumnos/Index" class="link link-primary link-bold">
					@AppStrings.Action_Manage @AppStrings.alumnos
				</a>
				<meter value="@Model.Alumnos" min="0" max="@Model.MaxAlumnos" high="@(Model.MaxAlumnos * 0.9)"> </meter>
			</div>
		</div>

		<div class="card" id="card-suscripcion">
			<h2>🗝️ @AppStrings.Text_Dashboard_MySuscripcion_Title</h2>
			<div class="card-content">
				<p>
					@AppStrings.dashboard_SubscribedToPlan <b>@Model.Entrenador.Suscripcion.Plan.ToString()</b>.
					@if (Model.Entrenador.Suscripcion.RenovacionAutomatica)
					{
						@AppStrings.dashboard_SubscriptionWillBeRenewedAt
						@Model.Entrenador.Suscripcion.FechaFin.ToString("D").ToLower()
					}
					else
					{
						@AppStrings.dashboard_SubscriptionWillEndAt
						@Model.Entrenador.Suscripcion.FechaFin.ToString("D").ToLower()
					}
					.
				</p>
				<a asp-page="Subscribe" asp-area="Dashboard" class="link link-primary link-bold">
					@AppStrings.masDetalles
				</a>

				@{
					var total = (Model.Entrenador.Suscripcion.FechaFin - Model.Entrenador.Suscripcion.FechaInicio).TotalDays;
					var completado = (DateTime.Now - Model.Entrenador.Suscripcion.FechaInicio).TotalDays;
					var high = total * 0.9;

					var t = total.ToString(CultureInfo.InvariantCulture);
					var c = completado.ToString(CultureInfo.InvariantCulture);
					var h = high.ToString(CultureInfo.InvariantCulture);
				}
				<meter value="@c" min="0" max="@t" high="@h"> </meter>
			</div>
		</div>

		<div class="card" id="card-entrenador">
			<h2>👤 @AppStrings.Text_Dashboard_MyAccount_Title</h2>
			<div class="card-content">
				<a asp-page="/Index" asp-area="Accounts" class="link link-primary link-bold">
					@AppStrings.Action_ManageAccount
				</a>

				<a asp-page="/Logout" asp-area="Accounts" class="link link-bad link-bold">
					@AppStrings.Action_Logout
				</a>
			</div>
		</div>

	</div>
</main>